version: 2

semantic_models:
  - name: devices
    description: |
      Semantic model for device analytics providing comprehensive device
      information from user sessions including device specifications, operating system details,
      and browser information for analysis and metrics.

      Based on the dim_device conforming layer model.
    
    model: ref('dim_device')
    
    # ========== Configuration ==========
    config:
      meta:
        domain: device
        owner: Analytics Team
        contains_pii: false
        update_frequency: real-time
    
    # ========== Entities ==========
    entities:
      - name: session
        type: primary
        expr: session_sk
        description: Session surrogate key
      
      - name: device
        type: foreign
        expr: device_sk
        description: Device surrogate key
      
      - name: user
        type: foreign
        expr: user_id
        description: User natural key (for non-rental contexts)
      
      - name: anonymous_user
        type: foreign
        expr: anonymous_id
        description: Anonymous user identifier
    
    # ========== Dimensions ==========
    dimensions:
      # Device Hardware Dimensions
      - name: device_type
        type: categorical
        config:
          meta:
            data_owner: "Finance team"
            used_in_reporting: true
            hierarchy:
              entity: Device
              category: Platform
              subcategory: Device Type

        expr: device_type
        description: Type of device (mobile, desktop, tablet)
        label: Device Type
      
      - name: device_manufacturer
        type: categorical
        expr: device_manufacturer
        description: Manufacturer of the device (Apple, Samsung, etc.)
        label: Device Manufacturer
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: Device Type
      
      - name: device_model
        type: categorical
        expr: device_model
        description: Specific model of the device
        label: Device Model
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: Device Type
      
      - name: device_category
        type: categorical
        expr: device_category
        description: Derived category for device type
        label: Device Category
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: Device Type
      
      # Operating System Dimensions
      - name: os_name
        type: categorical
        expr: os_name
        description: Operating system name (iOS, Android, Windows)
        label: OS Name
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: Os Browser
      
      - name: os_version
        type: categorical
        expr: os_version
        description: Version of the operating system
        label: OS Version
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: Os Browser
      
      - name: os_version_group
        type: categorical
        expr: os_version_group
        description: Grouped version of the operating system for analysis
        label: OS Version Group
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: Os Browser
      
      # Browser Dimensions
      - name: browser
        type: categorical
        expr: browser
        description: Browser name (Chrome, Safari, Firefox)
        label: Browser
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: Os Browser
      
      - name: browser_version
        type: categorical
        expr: browser_version
        description: Version of the browser
        label: Browser Version
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: Os Browser
      
      # Application Dimensions
      - name: app_name
        type: categorical
        expr: app_name
        description: Name of the application (for mobile app sessions)
        label: App Name
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: App Version
      
      - name: app_version
        type: categorical
        expr: app_version
        description: Version of the application
        label: App Version
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: App Version
      
      # Screen Dimensions
      - name: screen_height
        type: categorical
        expr: screen_height
        description: Height of the device screen in pixels
        label: Screen Height
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: Device Type
      
      - name: screen_width
        type: categorical
        expr: screen_width
        description: Width of the device screen in pixels
        label: Screen Width
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: Device Type
      
      - name: screen_aspect_ratio
        type: categorical
        expr: screen_aspect_ratio
        description: Aspect ratio of the screen
        label: Screen Aspect Ratio
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: Device Type
      
      # Context Dimensions
      - name: context_locale
        type: categorical
        expr: context_locale
        description: Locale setting of the device (en-US, etc.)
        label: Locale
        config:
          meta:
            hierarchy:
              entity: Device
              category: Geographic
              subcategory: Zone Type
      
      - name: context_timezone
        type: categorical
        expr: context_timezone
        description: Timezone of the device
        label: Timezone
        config:
          meta:
            hierarchy:
              entity: Device
              category: Geographic
              subcategory: Zone Type
      
      # Device Flags
      - name: is_mobile_app
        type: categorical
        expr: is_mobile_app
        description: Boolean flag indicating if session is from mobile app
        label: Is Mobile App
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: Device Type
      
      - name: is_bot
        type: categorical
        expr: is_bot
        description: Boolean flag indicating if session is from a bot
        label: Is Bot
        config:
          meta:
            hierarchy:
              entity: Device
              category: Platform
              subcategory: User Agent
