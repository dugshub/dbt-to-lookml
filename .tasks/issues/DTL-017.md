---
id: DTL-017
title: "Implement contextual project detection and smart defaults"
type: feature
status: ready
labels:
  - stack:backend
  - type:feature
  - priority:medium
  - state:spec-ready
created: 2025-11-12T20:50:00Z
updated: 2025-11-17T10:45:00Z
parent: DTL-014
---

# DTL-017: Implement contextual project detection and smart defaults

## Problem Statement

Add intelligence to detect project structure and suggest appropriate defaults for wizard prompts.

**Tasks**
- Create detection module: wizard/detection.py
- Implement semantic model directory detection (common names: semantic_models/, models/, dbt_models/)
- Detect existing LookML output directories
- Extract schema names from existing YAML files if present
- Provide smart defaults based on detected structure

**Acceptance Criteria**
- Detection finds semantic_models/ directory if it exists
- Suggests schema name from first parsed YAML file
- Detects build/lookml or lookml/ as likely output directories
- Returns sensible defaults when detection fails
- Detection is fast (<100ms) and doesn't parse all files

**Technical Notes**
- Use pathlib for cross-platform path handling
- Implement caching to avoid repeated filesystem scans
- Handle edge cases: multiple candidate directories, no YAML files
- Follow project patterns from parser.py

## Success Criteria

- [ ] Detection finds semantic_models/ directory if it exists
- [ ] Suggests schema name from first parsed YAML file
- [ ] Detects build/lookml or lookml/ as likely output directories
- [ ] Returns sensible defaults when detection fails
- [ ] Detection is fast (<100ms)
- [ ] Tests passing

## Links

- Epic: [DTL-014](./../epics/DTL-014.md)
- Strategy: [.tasks/strategies/DTL-017-strategy.md](./../strategies/DTL-017-strategy.md)
- Spec: [.tasks/specs/DTL-017-spec.md](./../specs/DTL-017-spec.md)

## History

### 2025-11-17 10:45 - Spec Generated
Generated comprehensive implementation spec via /implement:1-spec workflow.
- Strategy approved and used as foundation
- Detailed implementation plan with file-level guidance
- Complete code implementation provided
- 29 test cases specified with fixtures
- Ready for implementation

**Spec Location**: `.tasks/specs/DTL-017-spec.md`

**What's Included**:
- DetectionResult dataclass with fallback methods
- DetectionCache with 60-second TTL
- ProjectDetector class with prioritized directory search
- Lightweight schema extraction (no DbtParser overhead)
- Comprehensive test plan (100% coverage target)
- Performance requirements (<100ms)
- Cross-platform path handling

**Next Step**: `/implement DTL-017` or proceed with manual implementation

### 2025-11-12 20:50 - Issue Created
Created from epic DTL-014
