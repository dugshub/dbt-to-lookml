---
id: DTL-024
title: Update LookMLGenerator._resolve_measure_reference() to append suffix
type: feature
stack: backend
status: in-review
labels:
- type:feature
- stack:backend
- layer:molecules
- priority:medium
- state:has-spec
created: 2025-11-21 00:00:00+00:00
updated: '2025-11-21T14:47:40.596017Z'
parent: DTL-022
---


# DTL-024: Update LookMLGenerator._resolve_measure_reference() to append suffix

## Problem Statement

Modify _resolve_measure_reference() in generators/lookml.py to append `_measure` suffix to all measure references.

Changes needed:
1. Line 273 (same-view reference): Change from `${{{measure_name}}}` to `${{{measure_name}_measure}}`
2. Line 277 (cross-view reference): Change from `${{{view_name}.{measure_name}}}` to `${{{view_name}.{measure_name}_measure}}`

This ensures metrics correctly reference the suffixed measures created by Measure.to_lookml_dict().

Technical scope:
- File: src/dbt_to_lookml/generators/lookml.py
- Method: _resolve_measure_reference() (lines 242-277)
- Layer: Molecules (composition of atoms)

Testing requirements:
- Verify same-view references use suffixed names
- Verify cross-view references use suffixed names
- Test with simple, ratio, and derived metrics
- Maintain 95%+ branch coverage

Parent: Epic - Universal Measure Suffix and Hiding Strategy

## Success Criteria

- [ ] Same-view measure references include `_measure` suffix
- [ ] Cross-view measure references include `_measure` suffix
- [ ] Simple, ratio, and derived metrics work correctly
- [ ] Unit tests pass with updated expectations
- [ ] Branch coverage maintained at 95%+

## Links

- Epic: [DTL-022](./../epics/DTL-022.md)
- Strategy: [.tasks/strategies/DTL-024-strategy.md](./../strategies/DTL-024-strategy.md)
- Spec: [.tasks/specs/DTL-024-spec.md](./../specs/DTL-024-spec.md)

## History

### 2025-11-21 00:00 - Issue Created
Created from epic DTL-022

### 2025-11-21 - Implementation Spec Generated
Generated detailed implementation spec with exact code changes and test updates. Status updated to Ready with state:has-spec label.
