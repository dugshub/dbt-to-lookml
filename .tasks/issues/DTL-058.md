---
id: DTL-058
title: "Update documentation for derived metric PoP support"
type: chore
status: spec-ready
labels:
  - stack:backend
  - type:chore
created: 2025-12-22T23:00:00Z
updated: 2025-12-22T23:00:00Z
parent: DTL-054
---

# DTL-058: Update documentation for derived metric PoP support

## Problem Statement

The project documentation currently states that derived metrics don't support PoP.
Once the feature is implemented, documentation needs to be updated to reflect the
new capability and its requirements.

## What to Update

### CLAUDE.md

- Update the "Period-over-Period (PoP) on Metrics" section
- Remove or update the "Limitation" note about ratio/derived metrics
- Add example of derived metric with PoP config

### .claude/ai-docs/conversion-rules.md

- Add section on derived metric PoP support
- Document the "same-model" qualification criteria
- Include before/after LookML examples

## Documentation Content

- Explain qualifying criteria (all parents simple, same model)
- Show example YAML for derived metric with pop.enabled
- Show expected LookML output
- Note that cross-model derived metrics are still unsupported
- Mention recursive resolution for nested derived metrics

## Example Content

```yaml
# Derived metric with PoP - qualifies when all parents are simple on same model
metrics:
  - name: net_change_eom
    type: derived
    type_params:
      expr: gained - lost
      metrics:
        - name: gained_eom
        - name: lost_eom
    meta:
      primary_entity: facility
      pop:
        enabled: true
        comparisons: [py, pp]
        windows: [month]
```

## Success Criteria

- [ ] Implementation complete
- [ ] Tests passing
- [ ] Documentation updated

## Links

- Epic: [DTL-054](./../epics/DTL-054.md)
- Strategy: [.tasks/strategies/DTL-058-strategy.md](./../strategies/DTL-058-strategy.md)
- Spec: [.tasks/specs/DTL-058-spec.md](./../specs/DTL-058-spec.md)

## History

### 2025-12-22 23:00 - Issue Created
Created from epic DTL-054
