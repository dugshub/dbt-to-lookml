---
id: DTL-008
title: "Update Dimension schema to support convert_tz parameter"
type: feature
stack: backend
status: in-review
labels:
  - stack:backend
  - type:feature
  - layer:atoms
  - priority:high
  - schema:core
  - foundation:dtl-007
  - state:has-spec
created: 2025-11-12T20:00:00Z
updated: 2025-11-12T21:00:00Z
parent: DTL-007
---

# DTL-008: Update Dimension schema to support convert_tz parameter

## Problem Statement

Modify the `Dimension` class in `src/dbt_to_lookml/schemas.py` to support timezone conversion configuration:

**Tasks**:
1. Add optional `convert_tz` field to `Dimension` model (type: `bool | None`)
2. Update `_to_dimension_group_dict()` method to:
   - Accept optional `default_convert_tz` parameter (for propagating generator/CLI defaults)
   - Check for dimension-level override in `config.meta.convert_tz`
   - Apply precedence: dimension meta > default_convert_tz parameter > hardcoded default (False)
   - Add `convert_tz: yes|no` to the returned dictionary for dimension_groups
3. Update `Config` and `Meta` models if needed to support `convert_tz` in metadata
4. Ensure mypy strict typing compliance

**Files to modify**:
- `src/dbt_to_lookml/schemas.py` (Dimension, Config, Meta classes)

**Testing**:
- Unit tests in `test_schemas.py` to validate convert_tz handling
- Test precedence: meta override > default parameter > hardcoded default

**Acceptance Criteria**:
- Dimension._to_dimension_group_dict() accepts default_convert_tz parameter
- Dimension can read convert_tz from config.meta.convert_tz
- Precedence chain works correctly
- Type hints are correct and mypy passes

## Success Criteria

- [x] Implementation complete
- [x] Tests passing
- [x] Documentation updated

## Links

- Epic: [DTL-007](./../epics/DTL-007.md)
- Strategy: [.tasks/strategies/DTL-008-strategy.md](./../strategies/DTL-008-strategy.md)
- Spec: [.tasks/specs/DTL-008-spec.md](./../specs/DTL-008-spec.md)

## History

### 2025-11-12 21:00 - Implementation Complete
Committed changes to main branch:
- Added convert_tz: bool | None field to ConfigMeta class
- Updated _to_dimension_group_dict() method signature with default_convert_tz parameter
- Implemented three-tier precedence logic (meta > parameter > hardcoded default)
- Added TestDimensionConvertTz test class with 10 comprehensive tests
- All 269 unit tests passing
- mypy --strict type checking passed
- Code coverage: 97% for schemas.py
- Status changed to in-review

### 2025-11-12 20:00 - Issue Created
Created from epic DTL-007
