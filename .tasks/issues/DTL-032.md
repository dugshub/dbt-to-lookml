---
id: DTL-032
title: "Implement group_label in dimension_group generation"
type: feature
stack: backend
status: Ready
labels:
  - stack:backend
  - type:feature
  - priority:high
  - state:has-strategy
  - state:has-spec
created: 2025-11-19T08:00:00Z
updated: 2025-11-19T12:00:00Z
parent: DTL-029
---

# DTL-032: Implement group_label in dimension_group generation

## Problem Statement

Update the dimension_group generation logic to apply group_label with proper precedence handling.

## Scope

- Modify `Dimension._to_dimension_group_dict()` to accept `default_time_dimension_group_label` parameter
- Implement precedence logic: dimension meta > generator default > hardcoded default ("Time Dimensions")
- Apply `group_label` to dimension_group output dictionary
- Ensure dimension_group's `label` parameter is set for sub-grouping
- Handle case where user explicitly disables grouping (None or empty string)

## Implementation Details

Update method signature (schemas/semantic_layer.py):
```python
def _to_dimension_group_dict(
    self,
    default_convert_tz: bool | None = None,
    default_time_dimension_group_label: str | None = None,
) -> dict[str, Any]:
```

Add precedence logic:
```python
# Determine group_label with three-tier precedence
group_label = "Time Dimensions"  # Default
if default_time_dimension_group_label is not None:
    group_label = default_time_dimension_group_label
if self.config and self.config.meta and self.config.meta.time_dimension_group_label is not None:
    group_label = self.config.meta.time_dimension_group_label

# Apply group_label if not explicitly disabled
if group_label:
    result["group_label"] = group_label
```

Update SemanticModel.to_lookml_dict() to pass parameter through:
```python
dim_dict = dim._to_dimension_group_dict(
    default_convert_tz=convert_tz,
    default_time_dimension_group_label=time_dimension_group_label,
)
```

## Testing

- Unit test: dimension_group with meta override
- Unit test: dimension_group with generator default
- Unit test: dimension_group with hardcoded default
- Unit test: dimension_group with grouping explicitly disabled
- Integration test: full flow with multiple time dimensions

## Links

- Epic: [DTL-029](./../epics/DTL-029.md)
- Strategy: [.tasks/strategies/DTL-032-strategy.md](./../strategies/DTL-032-strategy.md)
- Spec: [.tasks/specs/DTL-032-spec.md](./../specs/DTL-032-spec.md)

## History

### 2025-11-19 12:00 - Spec Completed & Status Updated to Ready
Detailed implementation specification created at .tasks/specs/DTL-032-spec.md
- Complete step-by-step implementation instructions with exact code changes
- 11 comprehensive unit tests covering all precedence scenarios
- 2 integration tests for full workflow validation
- Golden test update strategy and examples
- Edge case handling documentation (empty string, None, hierarchy precedence)
- 6 LookML output examples demonstrating all configurations
- Code quality validation checklist and success criteria
- Issue status updated to Ready with state:has-spec label
- Prerequisites: Requires DTL-031 completion

### 2025-11-19 - Strategy Completed
Comprehensive implementation strategy created at .tasks/strategies/DTL-032-strategy.md
- Analyzed existing precedence patterns (convert_tz)
- Designed three-tier precedence logic (metadata > generator > default)
- Defined 10 unit tests + integration tests for 95%+ coverage
- Documented edge cases and LookML output examples
- Estimated 3.5-5.5 hours implementation effort

### 2025-11-19 08:00 - Issue Created
Created from epic DTL-029
