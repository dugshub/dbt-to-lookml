---
id: DTL-005
title: "Update unit tests for field sets and joins"
type: feature
stack: backend
status: ready
labels:
  - stack:backend
  - type:feature
  - priority:medium
  - state:has-spec
created: 2025-11-12T17:15:00Z
updated: 2025-11-12T23:30:00Z
parent: DTL-001
---

# DTL-005: Update unit tests for field sets and joins

## Problem Statement

Update unit tests in `src/tests/unit/` to cover new field set generation and join field constraints.

## What needs to be built

- Add tests to `test_lookml_generator.py` for dimension set generation
- Add tests for join fields parameter in explore generation
- Update existing test fixtures to expect sets in view output
- Update existing join tests to expect fields parameter
- Test edge cases: views with no dimensions, hidden-only dimensions, multi-hop joins with fields

## Why it's needed (connection to epic)

Unit tests ensure the field exposure control logic works correctly in isolation and maintains code coverage targets (95% branch coverage).

## Technical scope from labels

Backend testing work in `src/tests/unit/`:
- Add test cases to test_lookml_generator.py
- Update test fixtures and expected outputs
- Maintain 95% branch coverage target
- Follow pytest conventions and use parametrize for variations

## Testing requirements

- All new methods have corresponding unit tests
- Edge cases are covered (empty sets, hidden fields, etc.)
- Tests use clear arrange-act-assert structure
- Run with `make test-fast` for quick validation

## Success Criteria

- [ ] Implementation complete
- [ ] Tests passing
- [ ] Documentation updated

## Links
- Epic: [DTL-001](./../epics/DTL-001.md)
- Strategy: [.tasks/strategies/DTL-005-strategy.md](./../strategies/DTL-005-strategy.md)
- Spec: [.tasks/specs/DTL-005-spec.md](./../specs/DTL-005-spec.md)

## History
### 2025-11-12 23:30 - Implementation Spec Generated
Detailed implementation spec created at .tasks/specs/DTL-005-spec.md
- Defined 3 new test classes: TestGenerateDimensionSet (9 tests), TestJoinFieldsParameter (8 tests), TestDimensionSetEdgeCases (4 tests)
- Specified updates to 10 existing test methods across TestBuildJoinGraph, TestGenerateExploreslookml, TestLookMLGenerator
- Provided exact test implementations with arrange-act-assert structure
- Documented coverage validation approach for 95% target
- Total: 31 new/updated test cases (~530 lines of test code)
- Status changed to "ready" with state:has-spec label
### 2025-11-12 23:15 - Strategy Generated
Comprehensive test strategy posted to .tasks/strategies/DTL-005-strategy.md
- Added TestGenerateDimensionSet and TestJoinFieldsParameter test classes
- Planned updates to existing test fixtures and assertions
- Defined edge case coverage for empty views, hidden fields, multi-hop joins
- Established 95% branch coverage target with detailed breakdown
### 2025-11-12 17:15 - Issue Created
Created from epic DTL-001
