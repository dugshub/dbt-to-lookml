---
id: DTL-053
title: "Unit tests for date selector generation"
type: feature
status: refinement
labels:
  - stack:backend
  - type:feature
  - layer:features
  - tdd:true
created: 2025-12-17T21:30:00Z
updated: 2025-12-17T21:30:00Z
parent: DTL-046
---

# DTL-053: Unit tests for date selector generation

## Problem Statement

Comprehensive unit tests for the date selector feature covering both modes.

## Test Cases - Core Functionality

1. **Basic generation**: Fact model with multiple time dimensions generates
   parameter and calendar dimension_group
2. **No time dimensions**: Model without time dims skips date selector
3. **Single time dimension**: Still generates with one allowed_value
4. **Default selection**: Uses agg_time_dimension as default
5. **Missing default**: Falls back to first time dimension
6. **Label extraction**: Uses dimension label when available
7. **Feature disabled**: No date selector when flag is False
8. **Non-fact models**: Dimension-only models don't get date selector

## Test Cases - Auto Mode

9. **Auto includes all**: All time dimensions included by default
10. **Auto respects exclusion**: `date_selector: false` excludes dimension
11. **Auto ignores explicit true**: `date_selector: true` has no effect (already included)
12. **Auto all excluded**: If all dims have `false`, skip date selector

## Test Cases - Explicit Mode

13. **Explicit requires flag**: Only dims with `date_selector: true` included
14. **Explicit none flagged**: No dims flagged = skip date selector
15. **Explicit ignores false**: `date_selector: false` same as missing
16. **Explicit subset**: Mix of true/false/none only includes true

## Test Files

- Create `test_date_selector.py` for isolated unit tests
- Add integration tests to existing test files

## Fixtures

- Semantic model with multiple time dimensions (no meta flags)
- Semantic model with mixed date_selector flags
- Semantic model with all date_selector: false
- Semantic model with explicit mode flags

## Success Criteria

- [ ] Implementation complete
- [ ] Tests passing
- [ ] Documentation updated

## Links

- Epic: [DTL-046](./../epics/DTL-046.md)
- Strategy: [.tasks/strategies/DTL-053-strategy.md](./../strategies/DTL-053-strategy.md)
- Spec: [.tasks/specs/DTL-053-spec.md](./../specs/DTL-053-spec.md)

## History

### 2025-12-17 21:30 - Issue Created
Created from epic DTL-046
