---
id: DTL-034
title: "Update test suite for time dimension organization features"
type: feature
stack: backend
status: Ready
labels:
  - stack:backend
  - type:feature
  - priority:high
  - state:has-spec
created: 2025-11-19T08:00:00Z
updated: 2025-11-19T08:00:00Z
parent: DTL-029
---

# DTL-034: Update test suite for time dimension organization features

## Problem Statement

Comprehensive test coverage for the new time dimension organization features, including unit tests, integration tests, and golden file updates.

## Scope

- Update unit tests for ConfigMeta schema with time_dimension_group_label field
- Update unit tests for LookMLGenerator with new parameters
- Add unit tests for Dimension._to_dimension_group_dict() with group_label logic
- Add integration tests for full generation flow with time dimension grouping
- Update golden test files (.lkml) to include expected group_label output
- Add CLI tests for new flags (--time-dimension-group-label, --use-group-item-label)
- Verify 95%+ branch coverage maintained

## Test Cases

**Unit Tests (test_schemas.py):**
- ConfigMeta with time_dimension_group_label set
- ConfigMeta with time_dimension_group_label None (default)

**Unit Tests (test_lookml_generator.py):**
- LookMLGenerator with time_dimension_group_label parameter
- LookMLGenerator with use_group_item_label=True
- LookMLGenerator with use_group_item_label=False (default)

**Unit Tests (test_dimension.py or similar):**
- _to_dimension_group_dict() with meta override for group_label
- _to_dimension_group_dict() with generator default for group_label
- _to_dimension_group_dict() with hardcoded default ("Time Dimensions")
- _to_dimension_group_dict() with grouping disabled (empty string)
- group_item_label generation when use_group_item_label=True

**Integration Tests (test_integration.py):**
- End-to-end generation with multiple time dimensions
- Verify hierarchical organization in output
- Verify precedence: dimension meta > generator > default

**Golden Tests (test_golden.py):**
- Update expected_*.view.lkml files to include group_label
- Verify dimension_groups have group_label: "Time Dimensions"
- Add test case with custom group_label

**CLI Tests (test_cli.py):**
- Test --time-dimension-group-label flag
- Test --no-time-dimension-group-label flag
- Test --use-group-item-label flag
- Verify flags pass through to generator

## Coverage Target

- Maintain 95%+ branch coverage for modified modules
- All new code paths covered by tests
- Edge cases tested (None, empty string, override scenarios)

## Links

- Epic: [DTL-029](./../epics/DTL-029.md)
- Strategy: [.tasks/strategies/DTL-034-strategy.md](./../strategies/DTL-034-strategy.md)
- Spec: [.tasks/specs/DTL-034-spec.md](./../specs/DTL-034-spec.md)

## History

### 2025-11-19 08:00 - Issue Created
Created from epic DTL-029

### 2025-11-19 - Strategy Generated
Generated comprehensive testing strategy covering:
- Unit tests for ConfigMeta and Dimension schemas
- Unit tests for LookMLGenerator with new parameters
- Integration tests for end-to-end workflows
- Golden file updates for regression protection
- CLI tests for new flags (--time-dimension-group-label, --use-group-item-label)
- Edge case coverage
- 95%+ branch coverage target maintained

### 2025-11-19 - Implementation Spec Generated
Created detailed implementation spec (DTL-034-spec.md) with:
- 4 implementation phases (unit, integration/golden, CLI, edge cases)
- 40-45 new test methods across all test types
- Detailed code examples for each test class
- Golden file update instructions for 3 files
- Coverage targets: 95%+ for all modified modules
- Comprehensive testing checklist and success metrics
- Estimated effort: 4-6 hours total
Issue status updated to Ready with state:has-spec label
