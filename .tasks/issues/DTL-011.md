---
id: DTL-011
title: "Add comprehensive unit tests for timezone conversion"
type: feature
stack: backend
status: ready
labels:
  - stack:backend
  - type:feature
  - layer:testing
  - priority:high
  - state:spec-ready
created: 2025-11-12T20:00:00Z
updated: 2025-11-12T20:45:00Z
parent: DTL-007
---

# DTL-011: Add comprehensive unit tests for timezone conversion

## Problem Statement

Create comprehensive unit tests to validate timezone conversion behavior at all configuration levels (dimension meta, generator parameter, CLI flag, default):

**Tasks**:
1. Add tests in `test_schemas.py` for Dimension convert_tz handling:
   - Test dimension with convert_tz=True in meta
   - Test dimension with convert_tz=False in meta
   - Test dimension with no convert_tz (uses default)
   - Test precedence: meta > default_convert_tz parameter
2. Add tests in `test_lookml_generator.py` for generator propagation:
   - Test LookMLGenerator with convert_tz=True
   - Test LookMLGenerator with convert_tz=False
   - Test LookMLGenerator with convert_tz=None (default)
   - Test dimension meta override of generator setting
3. Add tests in `test_cli.py` for CLI flags:
   - Test `--convert-tz` flag
   - Test `--no-convert-tz` flag
   - Test no flag (uses default)
4. Ensure all tests validate the actual LookML output contains correct `convert_tz` value

**Files to modify**:
- `src/tests/unit/test_schemas.py`
- `src/tests/unit/test_lookml_generator.py`
- `src/tests/test_cli.py`

**Acceptance Criteria**:
- All new tests pass
- Branch coverage remains at 95%+
- Tests cover all precedence scenarios
- Tests validate actual LookML output

## Success Criteria

- [ ] Implementation complete
- [ ] Tests passing
- [ ] Documentation updated

## Links

- Epic: [DTL-007](./../epics/DTL-007.md)
- Strategy: [.tasks/strategies/DTL-011-strategy.md](./../strategies/DTL-011-strategy.md)
- Spec: [.tasks/specs/DTL-011-spec.md](./../specs/DTL-011-spec.md)

## History

### 2025-11-12 20:00 - Issue Created
Created from epic DTL-007
